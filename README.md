# Fix_Dates.ps1

### ğŸ“· Script to Fix Media File Timestamps Based on Associated JSON Metadata  
**Author:** SoggyCow  
**Repo:** [SoggyCow/Scripts](https://github.com/SoggyCow/Scripts)

---

## ğŸ§  Overview
This PowerShell script traverses a directory recursively, identifying supported media files (images and videos) and matching them to nearby `.json` metadata filesâ€”typically generated by Google Photos exports or similar services. If a matching JSON contains a valid `photoTakenTime` timestamp, the script updates the media file's **CreationTime** and **LastWriteTime** accordingly to reflect when the photo or video was originally taken.

---

## ğŸ“‚ Supported Media Formats
- `.png`, `.jpg`, `.jpeg`, `.bmp`
- `.mp4`, `.mov`, `.gif`, `.webm`, `.3gpp`, `.3gp`, `.webp`, `.heic`

---

## ğŸ” How Matching Works
- Uses the **base name** of each media file, escapes special characters, and compares with JSON file names using wildcard and fuzzy logic.
- Falls back to listing potential JSON matches if an exact pair isn't found.
- Errors are gracefully logged, ensuring robust traversal of even messy directories.

---

## ğŸ› ï¸ Key Features
- Recursively processes nested folders
- Smart filtering: excludes `.html`, `.ps1`, `.zip`, and unlisted media extensions
- Parses Unix timestamps from JSON and converts them to system-local time
- Updates timestamps only when valid data is presentâ€”no blind overwrites

---

## âš™ï¸ Requirements
- Windows PowerShell
- Valid JSON metadata files with a `photoTakenTime.timestamp` field

---

## ğŸš€ Usage
Run the script in the directory containing your media and JSON files:

```powershell
.\Fix_Dates.ps1
